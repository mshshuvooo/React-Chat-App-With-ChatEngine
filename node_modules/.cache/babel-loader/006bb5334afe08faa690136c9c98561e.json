{"ast":null,"code":"import _regeneratorRuntime from\"/Users/shuvo/Documents/Web-Development/Javascript/React-Serious/unichat-messenger/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/shuvo/Documents/Web-Development/Javascript/React-Serious/unichat-messenger/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/shuvo/Documents/Web-Development/Javascript/React-Serious/unichat-messenger/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useAuth}from'../contexts/authContext';import{useNavigate}from\"react-router-dom\";import{auth}from'../FirebaseConfig';import axios from'axios';import{ChatEngine}from'react-chat-engine';var Chats=function Chats(){var _useAuth=useAuth(),user=_useAuth.user;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var navigate=useNavigate();var getFile=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(url){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(url);case 2:response=_context.sent;_context.next=5;return response.blob();case 5:data=_context.sent;return _context.abrupt(\"return\",new File([data],\"user-photo.jpg\",{type:'image/jpeg'}));case 7:case\"end\":return _context.stop();}}},_callee);}));return function getFile(_x){return _ref.apply(this,arguments);};}();var handleLogOut=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return auth.signOut();case 2:navigate(\"/\");case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function handleLogOut(){return _ref2.apply(this,arguments);};}();useEffect(function(){if(!user){navigate(\"/\");return;}axios.get('https://api.chatengine.io/users/me',{headers:{\"project-id\":process.env.REACT_APP_CHAT_ENGINE_ID,\"user-name\":user.email,\"user-secret\":user.uid}}).then(function(){setLoading(false);}).catch(function(){var formDeta=new FormData();formDeta.append('email',user.email);formDeta.append('username',user.email);formDeta.append('secret',user.uid);getFile(user.photoURL).then(function(avatar){formDeta.append('avatar',avatar,avatar.name);axios.post('https://api.chatengine.io/users',formDeta,{headers:{'private-key':process.env.REACT_APP_CHAT_ENGINE_KEY}}).then(function(){return setLoading(false);}).catch(function(err){return console.log(err);});});});},[user,navigate]);if(!user||loading){return'Loading';}return/*#__PURE__*/React.createElement(\"div\",{className:\"chart-page\"},/*#__PURE__*/React.createElement(\"div\",{className:\"nav-bar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"logo-tab\"},/*#__PURE__*/React.createElement(\"span\",null,\"ChatBox\")),/*#__PURE__*/React.createElement(\"button\",{className:\"logout-tab\",onClick:handleLogOut},\"Log Out\")),/*#__PURE__*/React.createElement(ChatEngine,{height:\"calc(100vh - 85px)\",projectID:process.env.REACT_APP_CHAT_ENGINE_ID,userName:user.email,userSecret:user.uid}));};export default Chats;","map":{"version":3,"sources":["/Users/shuvo/Documents/Web-Development/Javascript/React-Serious/unichat-messenger/src/components/Chats.js"],"names":["React","useEffect","useState","useAuth","useNavigate","auth","axios","ChatEngine","Chats","user","loading","setLoading","navigate","getFile","url","fetch","response","blob","data","File","type","handleLogOut","signOut","get","headers","process","env","REACT_APP_CHAT_ENGINE_ID","email","uid","then","catch","formDeta","FormData","append","photoURL","avatar","name","post","REACT_APP_CHAT_ENGINE_KEY","err","console","log"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useAuth } from '../contexts/authContext';\nimport {useNavigate} from \"react-router-dom\"\n\nimport { auth } from '../FirebaseConfig';\nimport axios from 'axios';\nimport { ChatEngine } from 'react-chat-engine';\n\nconst Chats = () => {\n    const {user} = useAuth();\n    const [loading, setLoading] = useState(true);\n    const navigate = useNavigate();\n    const getFile = async (url) => {\n        const response = await fetch(url);\n        const data = await response.blob();\n        return new File( [data], \"user-photo.jpg\", { type: 'image/jpeg' } )\n    }\n\n    const handleLogOut = async () => {\n        await auth.signOut();\n        navigate(`/`)\n    }\n\n\n    useEffect( () => {\n        if(!user){\n            navigate(`/`);\n            return;\n        }\n        axios.get( 'https://api.chatengine.io/users/me', {\n            headers: {\n                \"project-id\" : process.env.REACT_APP_CHAT_ENGINE_ID,\n                \"user-name\" : user.email,\n                \"user-secret\" : user.uid\n            }\n        } ).then( () => {\n            setLoading(false);\n        } ).catch( () => {\n            let formDeta = new FormData();\n            formDeta.append('email', user.email);\n            formDeta.append('username', user.email);\n            formDeta.append('secret', user.uid);\n            getFile(user.photoURL).then( (avatar) => {\n                formDeta.append('avatar', avatar, avatar.name);\n\n                axios.post('https://api.chatengine.io/users', formDeta, {\n                    headers: { \n                        'private-key' : process.env.REACT_APP_CHAT_ENGINE_KEY\n                    }\n                }).then( () => setLoading(false) )\n                .catch( (err) => console.log(err) );\n            } )\n        } )\n\n        \n    }, [user, navigate] );\n\n    if(!user || loading){\n        return 'Loading';\n    }\n\n    return (\n        <div className=\"chart-page\">\n            <div className=\"nav-bar\">\n                <div className=\"logo-tab\">\n                    <span>ChatBox</span>\n                </div>\n                <button className=\"logout-tab\" onClick={handleLogOut}>\n                    Log Out\n                </button>\n            </div>\n            <ChatEngine \n                height=\"calc(100vh - 85px)\"\n                projectID= {process.env.REACT_APP_CHAT_ENGINE_ID}\n                userName={user.email}\n                userSecret={user.uid}\n            />\n        </div>\n    );\n};\n\nexport default Chats;"]},"metadata":{},"sourceType":"module"}